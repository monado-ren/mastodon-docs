<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=/favicon.ico><link rel=stylesheet href=https://docs.monado.ren/style.min.ac66b095598a93816a47e5ef5b071058047fa4bd8770cb4515ca10c1ad6f91c0.css><script src=https://docs.monado.ren/main.min.db37c27117ff8400e5e30549f6806d2bc825668b596d81316c6148417f59bc72.js async></script><title>Routes - Mastodon文档 -Monado-</title><meta property="og:type" content="article"><meta property="og:url" content="https://docs.monado.ren/en/dev/routes/"><meta name=description content="How HTTP methods map to controllers and actions."><meta property="og:description" content="How HTTP methods map to controllers and actions."><meta name=twitter:description content="How HTTP methods map to controllers and actions."><meta name=twitter:title content="Routes"><meta name=twitter:site content="@joinmastodon"><link rel=canonical href=https://docs.monado.ren/en/dev/routes/></head><body><div class="container sidebar-layout"><nav class=sidebar><a class=brand href=/><img class=link-logo src=/brand.svg alt=Mastodon></a><ul><li><a href=/en/>What is Mastodon?</a></li><li><span class=sub-title>Using Mastodon</span><ul class=sub-menu><li><a href=/en/user/signup/>Signing up for an account</a></li><li><a href=/en/user/profile/>Setting up your profile</a></li><li><a href=/en/user/posting/>Posting toots</a></li><li><a href=/en/user/network/>Using the network features</a></li><li><a href=/en/user/moderating/>Dealing with unwanted content</a></li><li><a href=/en/user/discoverability/>Promoting yourself and others</a></li><li><a href=/en/user/preferences/>Set your preferences</a></li><li><a href=/en/user/contacts/>More settings</a></li><li><a href=/en/user/external/>Using Mastodon externally</a></li><li><a href=/en/user/moving/>Moving or leaving accounts</a></li><li><a href=/en/user/run-your-own/>Running your own server</a></li></ul></li><li><span class=sub-title>Running Mastodon</span><ul class=sub-menu><li><a href=/en/admin/prerequisites/>Preparing your machine</a></li><li><a href=/en/admin/install/>Installing from source</a></li><li><a href=/en/admin/config/>Configuring your environment</a></li><li><a href=/en/admin/optional/>Installing optional features</a><ul class=sub-menu><li><a href=/en/admin/optional/elasticsearch/>Full-text search</a></li><li><a href=/en/admin/optional/tor/>Hidden services</a></li><li><a href=/en/admin/optional/sso/>Single Sign On</a></li></ul></li><li><a href=/en/admin/setup/>Setting up your new instance</a></li><li><a href=/en/admin/tootctl/>Using the admin CLI</a></li><li><a href=/en/admin/upgrading/>Upgrading to a new release</a></li><li><a href=/en/admin/backups/>Backing up your server</a></li><li><a href=/en/admin/migrating/>Migrating to a new machine</a></li><li><a href=/en/admin/scaling/>Scaling up your server</a></li><li><a href=/en/admin/moderation/>Moderation actions</a></li><li><a href=/en/admin/troubleshooting/>Troubleshooting errors</a><ul class=sub-menu><li><a href=/en/admin/troubleshooting/index-corruption/>Database index corruption</a></li></ul></li></ul></li><li><span class=sub-title>Developing Mastodon apps</span><ul class=sub-menu><li><a href=/en/client/intro/>Getting started with the API</a></li><li><a href=/en/client/public/>Playing with public data</a></li><li><a href=/en/client/token/>Obtaining client app access</a></li><li><a href=/en/client/authorized/>Logging in with an account</a></li><li><a href=/en/client/guidelines/>Guidelines and best practices</a></li><li><a href=/en/client/libraries/>Libraries and implementations</a></li></ul></li><li><span class=sub-title>Contributing to Mastodon</span><ul class=sub-menu><li><a href=/en/dev/overview/>Technical overview</a></li><li><a href=/en/dev/setup/>Setting up a dev environment</a></li><li><a href=/en/dev/code/>Code structure</a></li><li><a href=/en/dev/routes/ class=active>Routes</a></li><li><a href=/en/dev/disclosure/>Bug bounties and responsible disclosure</a></li></ul></li><li><span class=sub-title>Spec compliance</span><ul class=sub-menu><li><a href=/en/spec/activitypub/>ActivityPub</a></li><li><a href=/en/spec/webfinger/>WebFinger</a></li><li><a href=/en/spec/security/>Security</a></li><li><a href=/en/spec/microformats/>Microformats</a></li><li><a href=/en/spec/oauth/>OAuth</a></li><li><a href=/en/spec/bearcaps/>Bearcaps</a></li></ul></li><li><span class=sub-title>REST API</span><ul class=sub-menu><li><a href=/en/api/oauth-scopes/>OAuth Scopes</a></li><li><a href=/en/api/rate-limits/>Rate limits</a></li></ul></li><li><span class=sub-title>API Methods</span><ul class=sub-menu><li><a href=/en/methods/apps/>apps</a><ul class=sub-menu><li><a href=/en/methods/apps/oauth/>oauth</a></li></ul></li><li><a href=/en/methods/accounts/>accounts</a><ul class=sub-menu><li><a href=/en/methods/accounts/bookmarks/>bookmarks</a></li><li><a href=/en/methods/accounts/favourites/>favourites</a></li><li><a href=/en/methods/accounts/mutes/>mutes</a></li><li><a href=/en/methods/accounts/blocks/>blocks</a></li><li><a href=/en/methods/accounts/domain_blocks/>domain_blocks</a></li><li><a href=/en/methods/accounts/filters/>filters</a></li><li><a href=/en/methods/accounts/reports/>reports</a></li><li><a href=/en/methods/accounts/follow_requests/>follow_requests</a></li><li><a href=/en/methods/accounts/endorsements/>endorsements</a></li><li><a href=/en/methods/accounts/featured_tags/>featured_tags</a></li><li><a href=/en/methods/accounts/preferences/>preferences</a></li><li><a href=/en/methods/accounts/suggestions/>suggestions</a></li></ul></li><li><a href=/en/methods/statuses/>statuses</a><ul class=sub-menu><li><a href=/en/methods/statuses/media/>media</a></li><li><a href=/en/methods/statuses/polls/>polls</a></li><li><a href=/en/methods/statuses/scheduled_statuses/>scheduled_statuses</a></li></ul></li><li><a href=/en/methods/timelines/>timelines</a><ul class=sub-menu><li><a href=/en/methods/timelines/conversations/>conversations</a></li><li><a href=/en/methods/timelines/lists/>lists</a></li><li><a href=/en/methods/timelines/markers/>markers</a></li><li><a href=/en/methods/timelines/streaming/>streaming</a></li></ul></li><li><a href=/en/methods/notifications/>notifications</a><ul class=sub-menu><li><a href=/en/methods/notifications/push/>push</a></li></ul></li><li><a href=/en/methods/search/>search</a></li><li><a href=/en/methods/instance/>instance</a><ul class=sub-menu><li><a href=/en/methods/instance/trends/>trends</a></li><li><a href=/en/methods/instance/directory/>directory</a></li><li><a href=/en/methods/instance/custom_emojis/>custom_emojis</a></li></ul></li><li><a href=/en/methods/admin/>admin</a></li><li><a href=/en/methods/announcements/>announcements</a></li><li><a href=/en/methods/proofs/>proofs</a></li><li><a href=/en/methods/oembed/>oembed</a></li></ul></li><li><span class=sub-title>API Entities</span><ul class=sub-menu><li><a href=/en/entities/account/>Account</a></li><li><a href=/en/entities/activity/>Activity</a></li><li><a href=/en/entities/admin-account/>Admin::Account</a></li><li><a href=/en/entities/admin-report/>Admin::Report</a></li><li><a href=/en/entities/announcement/>Announcement</a></li><li><a href=/en/entities/announcementreaction/>AnnouncementReaction</a></li><li><a href=/en/entities/application/>Application</a></li><li><a href=/en/entities/attachment/>Attachment</a></li><li><a href=/en/entities/card/>Card</a></li><li><a href=/en/entities/context/>Context</a></li><li><a href=/en/entities/conversation/>Conversation</a></li><li><a href=/en/entities/emoji/>Emoji</a></li><li><a href=/en/entities/error/>Error</a></li><li><a href=/en/entities/featuredtag/>FeaturedTag</a></li><li><a href=/en/entities/field/>Field</a></li><li><a href=/en/entities/filter/>Filter</a></li><li><a href=/en/entities/history/>History</a></li><li><a href=/en/entities/identityproof/>IdentityProof</a></li><li><a href=/en/entities/instance/>Instance</a></li><li><a href=/en/entities/list/>List</a></li><li><a href=/en/entities/marker/>Marker</a></li><li><a href=/en/entities/mention/>Mention</a></li><li><a href=/en/entities/notification/>Notification</a></li><li><a href=/en/entities/poll/>Poll</a></li><li><a href=/en/entities/preferences/>Preferences</a></li><li><a href=/en/entities/pushsubscription/>PushSubscription</a></li><li><a href=/en/entities/relationship/>Relationship</a></li><li><a href=/en/entities/report/>Report</a></li><li><a href=/en/entities/results/>Results</a></li><li><a href=/en/entities/scheduledstatus/>ScheduledStatus</a></li><li><a href=/en/entities/source/>Source</a></li><li><a href=/en/entities/status/>Status</a></li><li><a href=/en/entities/tag/>Tag</a></li><li><a href=/en/entities/token/>Token</a></li></ul></li></ul></nav><main><h1>Routes</h1><p>How HTTP methods map to controllers and actions.</p><aside><nav id=TableOfContents><ul><li><ul><li><a href=#routes>Explanation of routes</a></li><li><a href=#well-known>.well-known</a></li><li><a href=#public>Public URIs</a></li><li><a href=#api>API</a></li></ul></li></ul></nav></aside><div class=e-content><a href=https://github.com/tootsuite/mastodon/blob/master/config/routes.rb class=page-ref><div class=page-ref-icon><i class="fa fa-external-link-square-alt"></i></div>config/routes.rb</a><h2 id=routes>Explanation of routes</h2><p>Mastodon uses Ruby on Rails, which defines its router configuration at config/routes.rb. You may view the <a href=https://guides.rubyonrails.org/routing.html>Ruby on Rails routing guide</a> for more detailed information, but this page will explain the basics of how Mastodon handles routing.</p><h3 id=router>How routes are constructed</h3><p><code>namespace</code> is a prefix for routes mapped to a certain controller directory. <code>resources</code> are mapped to controllers within that namespace directory. <code>scope</code> passes to the <code>module</code>'s controller. For example, consider the following abbreviated code:</p><figure><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>namespace <span style=color:#f1fa8c>:api</span> <span style=color:#ff79c6>do</span>
    namespace <span style=color:#f1fa8c>:v1</span> <span style=color:#ff79c6>do</span>
        resources <span style=color:#f1fa8c>:statuses</span>, only <span style=color:#ff79c6>[</span><span style=color:#f1fa8c>:create</span>, <span style=color:#f1fa8c>:show</span>, <span style=color:#f1fa8c>:destroy</span><span style=color:#ff79c6>]</span> <span style=color:#ff79c6>do</span>
            scope <span style=color:#f1fa8c>module</span>: <span style=color:#f1fa8c>:statuses</span> <span style=color:#ff79c6>do</span>
                resource <span style=color:#f1fa8c>:favourite</span>, <span style=color:#f1fa8c>only</span>: <span style=color:#f1fa8c>:create</span>
                resource <span style=color:#f1fa8c>:unfavourite</span>, <span style=color:#f1fa8c>to</span>: <span style=color:#f1fa8c>&#39;favourites#destroy&#39;</span>
                member <span style=color:#ff79c6>do</span>
                    get <span style=color:#f1fa8c>:context</span>
                <span style=color:#ff79c6>end</span>
            <span style=color:#ff79c6>end</span>
        <span style=color:#ff79c6>end</span>
    <span style=color:#ff79c6>end</span>
<span style=color:#ff79c6>end</span>
</code></pre></div><figcaption><p>config/routes.rb excerpt</p></figcaption></figure><p>The first available resource is :statuses, which is nested under the :api and :v1 namespaces. Thus, the resulting HTTP route will be /api/v1/statuses. The <code>only</code> defines certain allowed methods, which are to be defined in the controller at <code>app/controllers/api/v1/statuses_controller.rb</code>.</p><p>Within /api/v1/statuses, there is a scope for a module :statuses, where additional resources are defined. The controllers for these resources live in <code>app/controllers/api/v1/statuses/</code>. For example, :favourite will be handled by the #create action within <code>app/controllers/api/v1/statuses/favourites_controller.rb</code> and :unfavourite will be handled within the same controller, but by the #destroy action.</p><p>There is also a custom method defined for any <code>member</code> within this scope, or in other words, for any status to be controlled by <code>app/controllers/api/v1/statuses_controller.rb</code>, which is mapped to GET /api/v1/statuses/:id/context and handled by the :context action defined within that controller.</p><h3 id=methods>Available methods</h3><h4 id=index>:index</h4><p>Maps to HTTP GET, for a list. Handled by the #index action in a controller.</p><h4 id=show>:show</h4><p>Maps to HTTP GET, for a single view. Handled by the #show action in a controller.</p><h4 id=create>:create</h4><p>Maps to HTTP POST. Handled by the #create action in a controller.</p><h4 id=update>:update</h4><p>Maps to HTTP PUT. Handled by the #update action in a controller.</p><h4 id=destroy>:destroy</h4><p>Maps to HTTP DELETE. Handled by the #destroy action in a controller.</p><h2 id=well-known>.well-known</h2><h3 id=host-meta>/.well-known/host-meta</h3><p>Extensible Resource Descriptor (XRD). Advertises existence of Webfinger.</p><h3 id=nodeinfo>/.well-known/nodeinfo</h3><p>Maps to NodeInfo 2.0 endpoint at <code>/nodeinfo/2.0</code>, used for advertising software name and version, protocols, usage statistics, and whether registrations are open.</p><h3 id=webfinger>/.well-know/webfinger</h3><p>Used for discovering ActivityPub actor id. See <a href=/en/spec/webfinger/>Spec compliance > WebFinger</a> for more information.</p><h3 id=change-password>/.well-known/change-password</h3><p>Maps to account settings page.</p><h3 id=keybase>/.well-known/keybase-proof-config</h3><p>Used for integration with Keybase, defining which usernames are acceptable and where proofs may be checked.</p><div class="hint hint-warning"><div class=hint-icon><i class="fa fa-exclamation-circle"></i></div>The sections below this point are under construction.</div><h2 id=public>Public URIs</h2><ul><li><code>/users/username</code> = user URI</li><li><code>/users/username/remote_follow</code> = remote follow dialog</li><li><code>/users/username/statuses/id</code> = status URI</li><li><code>/@username</code> = &ldquo;toots&rdquo; tab</li><li><code>/@username/with_replies</code> = &ldquo;toots and replies&rdquo; tab</li><li><code>/@username/media</code> = &ldquo;media&rdquo; tab</li><li><code>/@username/tagged/:hashtag</code> = tagged statuses by user</li><li><code>/@username/:status_id</code> = status permalink</li><li><code>/@username/:status_id/embed</code> = embeddable version</li><li><code>/interact/:status_id</code> = remote interaction dialog</li><li><code>/explore</code> = profile directory</li><li><code>/explore/:hashtag</code> = profiles with this hashtag in bio</li><li><code>/public</code> = public timeline preview</li><li><code>/about</code> = landing page</li><li><code>/about/more</code> = extended description</li><li><code>/terms</code> = terms of service</li></ul><h2 id=api>API</h2><ul><li>/api/oembed</li><li>/api/proofs</li><li>/api/v1<ul><li><a href=/en/methods/statuses/>statuses</a> [create, show, destroy]<ul><li>reblogged_by [index]</li><li>favourited_by [index]</li><li>reblog [create]</li><li>unreblog [POST reblog#destroy]</li><li>favourite [create]</li><li>unfavourite [POST favourites#destroy]</li><li>bookmark [create]</li><li>unbookmark [POST bookmarks#destroy]</li><li>mute [create]</li><li>unmute [POST mutes#destroy]</li><li>pin [create]</li><li>unpin [POST pins#destroy]</li><li>context [GET]</li></ul></li><li><a href=/en/methods/timelines/>timelines</a><ul><li>home [show]</li><li>public [show]</li><li>tag [show]</li><li>list [show]</li></ul></li><li><a href=/en/methods/timelines/streaming/>streaming</a> [index]</li><li><a href=/en/methods/instance/custom_emojis/>custom_emojis</a> [index]</li><li><a href=/en/methods/accounts/suggestions/>suggestions</a> [index, destroy]</li><li><a href=/en/methods/statuses/scheduled_statuses/>scheduled_statuses</a> [index, show, update, destroy]</li><li><a href=/en/methods/accounts/preferences/>preferences</a> [index]</li><li><a href=/en/methods/timelines/conversations/>conversations</a> [index, destroy]<ul><li>read [POST]</li></ul></li><li><a href=/en/methods/statuses/media/>media</a> [create, update]</li><li><a href=/en/methods/accounts/blocks/>blocks</a> [index]</li><li><a href=/en/methods/accounts/mutes/>mutes</a> [index]</li><li><a href=/en/methods/accounts/favourites/>favourites</a> [index]</li><li><a href=/en/methods/accounts/bookmarks/>bookmarks</a> [index]</li><li><a href=/en/methods/accounts/reports/>reports</a> [create]</li><li><a href=/en/methods/instance/trends/>trends</a> [index]</li><li><a href=/en/methods/accounts/filters/>filters</a> [index, create, show, update, destroy]</li><li><a href=/en/methods/accounts/endorsements/>endorsements</a> [index]</li><li><a href=/en/methods/timelines/markers/>markers</a> [index, create]</li><li><a href=/en/methods/apps/>apps</a> [create]<ul><li>verify_credentials [credentials#show]</li></ul></li><li><a href=/en/methods/instance/>instance</a> [show]<ul><li>peers [index]</li><li>activity [show]</li></ul></li><li><a href=/en/methods/accounts/domain_blocks/>domain_blocks</a> [show, create, destroy]</li><li><a href=/en/methods/instance/directory/>directory</a> [show]</li><li><a href=/en/methods/accounts/follow_requests/>follow_requests</a> [index]<ul><li>authorize [POST]</li><li>reject [POST]</li></ul></li><li><a href=/en/methods/notifications/>notifications</a> [index, show]<ul><li>clear [POST]</li><li>dismiss [POST]</li></ul></li><li><a href=/en/methods/accounts/>accounts</a><ul><li>verify_credentials [GET credentials#show]</li><li>update_credentials [PATCH credentials#update]</li><li>search [show (search#index)]</li><li>relationships [index]</li></ul></li><li><a href=/en/methods/accounts/>accounts</a> [create, show]<ul><li>statuses [index accounts/statuses]</li><li>followers [index accounts/follower_accounts]</li><li>following [index accounts/following_accounts]</li><li>lists [index accounts/lists]</li><li>identity_proofs [index accounts/identity_proofs]</li><li>follow [POST]</li><li>unfollow [POST]</li><li>block [POST]</li><li>unblock [POST]</li><li>mute [POST]</li><li>unmute [POST]</li><li>pin [POST]</li><li>unpin [POST]</li></ul></li><li><a href=/en/methods/timelines/lists/>lists</a> [index, create, show, update, destroy]<ul><li>accounts [POST accounts/pins#destroy]</li></ul></li><li><a href=/en/methods/accounts/featured_tags/>featured_tags</a> [index, create, destroy]<ul><li>suggestions [GET suggestions#index]</li></ul></li><li><a href=/en/methods/statuses/polls/>polls</a> [create, show]<ul><li>votes [create polls/votes]</li></ul></li><li><a href=/en/methods/notifications/push/>push</a><ul><li>subscription [create, show, update, destroy]</li></ul></li><li><a href=/en/methods/admin/>admin</a><ul><li>accounts [index, show]<ul><li>enable [POST]</li><li>unsilence [POST]</li><li>unsuspend [POST]</li><li>approve [POST]</li><li>reject [POST]</li><li>action [create account_actions]</li></ul></li><li>reports [index, show]<ul><li>assign_to_self [POST]</li><li>unassign [POST]</li><li>reopen [POST]</li><li>resolve [POST]</li></ul></li></ul></li></ul></li><li>/api/v2<ul><li><a href=/en/methods/search/>search</a> [GET search#index]</li></ul></li></ul><p style=color:#687590>Last updated January 12, 2020 · <a href=https://github.com/chasedream1129/mastodon-docs/tree/master/content/en/dev/routes.md style=color:#687590>Improve this page</a></p></div></main></div></body></html>