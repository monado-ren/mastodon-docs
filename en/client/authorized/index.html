<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=/favicon.ico><link rel=stylesheet href=https://docs.monado.ren/style.min.ac66b095598a93816a47e5ef5b071058047fa4bd8770cb4515ca10c1ad6f91c0.css><script src=https://docs.monado.ren/main.min.db37c27117ff8400e5e30549f6806d2bc825668b596d81316c6148417f59bc72.js async></script><title>Logging in with an account - Mastodon文档 -Monado-</title><meta property="og:type" content="article"><meta property="og:url" content="https://docs.monado.ren/en/client/authorized/"><meta name=description content="How to obtain authorization from a user and perform actions on their behalf."><meta property="og:description" content="How to obtain authorization from a user and perform actions on their behalf."><meta name=twitter:description content="How to obtain authorization from a user and perform actions on their behalf."><meta name=twitter:title content="Logging in with an account"><meta name=twitter:site content="@joinmastodon"><link rel=canonical href=https://docs.monado.ren/en/client/authorized/></head><body><div class="container sidebar-layout"><nav class=sidebar><a class=brand href=/><img class=link-logo src=/brand.svg alt=Mastodon></a><ul><li><a href=/en/>What is Mastodon?</a></li><li><span class=sub-title>Using Mastodon</span><ul class=sub-menu><li><a href=/en/user/signup/>Signing up for an account</a></li><li><a href=/en/user/profile/>Setting up your profile</a></li><li><a href=/en/user/posting/>Posting toots</a></li><li><a href=/en/user/network/>Using the network features</a></li><li><a href=/en/user/moderating/>Dealing with unwanted content</a></li><li><a href=/en/user/discoverability/>Promoting yourself and others</a></li><li><a href=/en/user/preferences/>Set your preferences</a></li><li><a href=/en/user/contacts/>More settings</a></li><li><a href=/en/user/external/>Using Mastodon externally</a></li><li><a href=/en/user/moving/>Moving or leaving accounts</a></li><li><a href=/en/user/run-your-own/>Running your own server</a></li></ul></li><li><span class=sub-title>Running Mastodon</span><ul class=sub-menu><li><a href=/en/admin/prerequisites/>Preparing your machine</a></li><li><a href=/en/admin/install/>Installing from source</a></li><li><a href=/en/admin/config/>Configuring your environment</a></li><li><a href=/en/admin/optional/>Installing optional features</a><ul class=sub-menu><li><a href=/en/admin/optional/elasticsearch/>Full-text search</a></li><li><a href=/en/admin/optional/tor/>Hidden services</a></li><li><a href=/en/admin/optional/sso/>Single Sign On</a></li></ul></li><li><a href=/en/admin/setup/>Setting up your new instance</a></li><li><a href=/en/admin/tootctl/>Using the admin CLI</a></li><li><a href=/en/admin/upgrading/>Upgrading to a new release</a></li><li><a href=/en/admin/backups/>Backing up your server</a></li><li><a href=/en/admin/migrating/>Migrating to a new machine</a></li><li><a href=/en/admin/scaling/>Scaling up your server</a></li><li><a href=/en/admin/moderation/>Moderation actions</a></li><li><a href=/en/admin/troubleshooting/>Troubleshooting errors</a><ul class=sub-menu><li><a href=/en/admin/troubleshooting/index-corruption/>Database index corruption</a></li></ul></li></ul></li><li><span class=sub-title>Developing Mastodon apps</span><ul class=sub-menu><li><a href=/en/client/intro/>Getting started with the API</a></li><li><a href=/en/client/public/>Playing with public data</a></li><li><a href=/en/client/token/>Obtaining client app access</a></li><li><a href=/en/client/authorized/ class=active>Logging in with an account</a></li><li><a href=/en/client/guidelines/>Guidelines and best practices</a></li><li><a href=/en/client/libraries/>Libraries and implementations</a></li></ul></li><li><span class=sub-title>Contributing to Mastodon</span><ul class=sub-menu><li><a href=/en/dev/overview/>Technical overview</a></li><li><a href=/en/dev/setup/>Setting up a dev environment</a></li><li><a href=/en/dev/code/>Code structure</a></li><li><a href=/en/dev/routes/>Routes</a></li><li><a href=/en/dev/disclosure/>Bug bounties and responsible disclosure</a></li></ul></li><li><span class=sub-title>Spec compliance</span><ul class=sub-menu><li><a href=/en/spec/activitypub/>ActivityPub</a></li><li><a href=/en/spec/webfinger/>WebFinger</a></li><li><a href=/en/spec/security/>Security</a></li><li><a href=/en/spec/microformats/>Microformats</a></li><li><a href=/en/spec/oauth/>OAuth</a></li><li><a href=/en/spec/bearcaps/>Bearcaps</a></li></ul></li><li><span class=sub-title>REST API</span><ul class=sub-menu><li><a href=/en/api/oauth-scopes/>OAuth Scopes</a></li><li><a href=/en/api/rate-limits/>Rate limits</a></li></ul></li><li><span class=sub-title>API Methods</span><ul class=sub-menu><li><a href=/en/methods/apps/>apps</a><ul class=sub-menu><li><a href=/en/methods/apps/oauth/>oauth</a></li></ul></li><li><a href=/en/methods/accounts/>accounts</a><ul class=sub-menu><li><a href=/en/methods/accounts/bookmarks/>bookmarks</a></li><li><a href=/en/methods/accounts/favourites/>favourites</a></li><li><a href=/en/methods/accounts/mutes/>mutes</a></li><li><a href=/en/methods/accounts/blocks/>blocks</a></li><li><a href=/en/methods/accounts/domain_blocks/>domain_blocks</a></li><li><a href=/en/methods/accounts/filters/>filters</a></li><li><a href=/en/methods/accounts/reports/>reports</a></li><li><a href=/en/methods/accounts/follow_requests/>follow_requests</a></li><li><a href=/en/methods/accounts/endorsements/>endorsements</a></li><li><a href=/en/methods/accounts/featured_tags/>featured_tags</a></li><li><a href=/en/methods/accounts/preferences/>preferences</a></li><li><a href=/en/methods/accounts/suggestions/>suggestions</a></li></ul></li><li><a href=/en/methods/statuses/>statuses</a><ul class=sub-menu><li><a href=/en/methods/statuses/media/>media</a></li><li><a href=/en/methods/statuses/polls/>polls</a></li><li><a href=/en/methods/statuses/scheduled_statuses/>scheduled_statuses</a></li></ul></li><li><a href=/en/methods/timelines/>timelines</a><ul class=sub-menu><li><a href=/en/methods/timelines/conversations/>conversations</a></li><li><a href=/en/methods/timelines/lists/>lists</a></li><li><a href=/en/methods/timelines/markers/>markers</a></li><li><a href=/en/methods/timelines/streaming/>streaming</a></li></ul></li><li><a href=/en/methods/notifications/>notifications</a><ul class=sub-menu><li><a href=/en/methods/notifications/push/>push</a></li></ul></li><li><a href=/en/methods/search/>search</a></li><li><a href=/en/methods/instance/>instance</a><ul class=sub-menu><li><a href=/en/methods/instance/trends/>trends</a></li><li><a href=/en/methods/instance/directory/>directory</a></li><li><a href=/en/methods/instance/custom_emojis/>custom_emojis</a></li></ul></li><li><a href=/en/methods/admin/>admin</a></li><li><a href=/en/methods/announcements/>announcements</a></li><li><a href=/en/methods/proofs/>proofs</a></li><li><a href=/en/methods/oembed/>oembed</a></li></ul></li><li><span class=sub-title>API Entities</span><ul class=sub-menu><li><a href=/en/entities/account/>Account</a></li><li><a href=/en/entities/activity/>Activity</a></li><li><a href=/en/entities/admin-account/>Admin::Account</a></li><li><a href=/en/entities/admin-report/>Admin::Report</a></li><li><a href=/en/entities/announcement/>Announcement</a></li><li><a href=/en/entities/announcementreaction/>AnnouncementReaction</a></li><li><a href=/en/entities/application/>Application</a></li><li><a href=/en/entities/attachment/>Attachment</a></li><li><a href=/en/entities/card/>Card</a></li><li><a href=/en/entities/context/>Context</a></li><li><a href=/en/entities/conversation/>Conversation</a></li><li><a href=/en/entities/emoji/>Emoji</a></li><li><a href=/en/entities/error/>Error</a></li><li><a href=/en/entities/featuredtag/>FeaturedTag</a></li><li><a href=/en/entities/field/>Field</a></li><li><a href=/en/entities/filter/>Filter</a></li><li><a href=/en/entities/history/>History</a></li><li><a href=/en/entities/identityproof/>IdentityProof</a></li><li><a href=/en/entities/instance/>Instance</a></li><li><a href=/en/entities/list/>List</a></li><li><a href=/en/entities/marker/>Marker</a></li><li><a href=/en/entities/mention/>Mention</a></li><li><a href=/en/entities/notification/>Notification</a></li><li><a href=/en/entities/poll/>Poll</a></li><li><a href=/en/entities/preferences/>Preferences</a></li><li><a href=/en/entities/pushsubscription/>PushSubscription</a></li><li><a href=/en/entities/relationship/>Relationship</a></li><li><a href=/en/entities/report/>Report</a></li><li><a href=/en/entities/results/>Results</a></li><li><a href=/en/entities/scheduledstatus/>ScheduledStatus</a></li><li><a href=/en/entities/source/>Source</a></li><li><a href=/en/entities/status/>Status</a></li><li><a href=/en/entities/tag/>Tag</a></li><li><a href=/en/entities/token/>Token</a></li></ul></li></ul></nav><main><h1>Logging in with an account</h1><p>How to obtain authorization from a user and perform actions on their behalf.</p><aside><nav id=TableOfContents><ul><li><ul><li><a href=#scopes>Scopes explained</a></li><li><a href=#flow>Example authorization code flow</a></li><li><a href=#actions>Performing actions as the authorized user</a></li></ul></li></ul></nav></aside><div class=e-content><h2 id=scopes>Scopes explained</h2><p>When we registered our app and when we will authorize our user, we need to define what exactly our generated token will have permission to do. This is done through the use of OAuth scopes. Each API method has an associated scope, and can only be called if the token being used for authorization has been generated with the corresponding scope.</p><p>Scopes must be a subset. When we created our app, we specified <code>read write follow push</code> &ndash; we could simply request all available scopes by specifying <code>read write follow push</code>, but it is a better idea to only request what your app will actually need through granular scopes. See <a href=/en/api/oauth-scopes/>OAuth Scopes</a> for a full list of scopes. Each API method's documentation will also specify the OAuth access level and scope required to call it.</p><h2 id=flow><strong>Example authorization code flow</strong></h2><p>This is similar to the authentication flow from before, but this time, we need to obtain authorization from a user as well.</p><h3 id=client>Client ID and secret</h3><p>First, if you have not already registered a client application, then see <a href=/en/client/token/#creating-our-application>Creating our application</a> on the previous page or go directly to <a href=/en/methods/apps/#create-an-application>POST /api/v1/apps</a> for the full documentation of that method. We will need the <code>client_id</code> and <code>client_secret</code> for our application.</p><h3 id=login>Authorize the user</h3><p>To authorize a user, request <a href=/en/methods/apps/oauth/#authorize-a-user>GET /oauth/authorize</a> in a browser with the following query parameters:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>https://mastodon.example/oauth/authorize
?client_id<span style=color:#ff79c6>=</span>CLIENT_ID
&amp;<span style=color:#8be9fd;font-style:italic>scope</span><span style=color:#ff79c6>=</span>read+write+follow+push
&amp;<span style=color:#8be9fd;font-style:italic>redirect_uri</span><span style=color:#ff79c6>=</span>urn:ietf:wg:oauth:2.0:oob
&amp;<span style=color:#8be9fd;font-style:italic>response_type</span><span style=color:#ff79c6>=</span>code
</code></pre></div><p>Note the following:</p><ul><li><code>client_id</code> and <code>client_secret</code> were obtained when registering our application.</li><li><code>scope</code> must be a subset of our registered app's registered scopes. It is a good idea to only request what you need. See <a href=/en/api/oauth-scopes/>OAuth Scopes</a> for more information.</li><li><code>redirect_uri</code> is one of the URIs we registered with our app. We are still using &ldquo;out of band&rdquo; for this example, which means we will have to manually copy and paste the resulting code, but if you registered your application with a URI that you control, then the code will be returned as a query parameter <code>code</code> and can be logged by your request handler. See the response section of the API method documentation for more information on this.</li></ul><h3 id=token>Obtain the token</h3><p>Now that we have an authorization <code>code</code>, let's obtain an access token that will authenticate our requests as the authorized user. To do so, use <a href=/en/methods/apps/oauth/#obtain-a-token>POST /oauth/token</a> like before, but pass the authorization code we just obtained:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -X POST <span style=color:#f1fa8c>\
</span><span style=color:#f1fa8c></span>	-F <span style=color:#f1fa8c>&#39;client_id=your_client_id_here&#39;</span> <span style=color:#f1fa8c>\
</span><span style=color:#f1fa8c></span>	-F <span style=color:#f1fa8c>&#39;client_secret=your_client_secret_here&#39;</span> <span style=color:#f1fa8c>\
</span><span style=color:#f1fa8c></span>	-F <span style=color:#f1fa8c>&#39;redirect_uri=urn:ietf:wg:oauth:2.0:oob&#39;</span> <span style=color:#f1fa8c>\
</span><span style=color:#f1fa8c></span>	-F <span style=color:#f1fa8c>&#39;grant_type=authorization_code&#39;</span> <span style=color:#f1fa8c>\
</span><span style=color:#f1fa8c></span>	-F <span style=color:#f1fa8c>&#39;code=user_authzcode_here&#39;</span> <span style=color:#f1fa8c>\
</span><span style=color:#f1fa8c></span>	-F <span style=color:#f1fa8c>&#39;scope=read write follow push&#39;</span> <span style=color:#f1fa8c>\
</span><span style=color:#f1fa8c></span>	https://mastodon.example/oauth/token
</code></pre></div><p>Note the following:</p><ul><li><code>client_id</code> and <code>client_secret</code> were provided in the response text when you registered your application.</li><li><code>redirect_uri</code> must be one of the URIs defined when registering the application.</li><li>We are requesting a <code>grant_type</code> of <code>authorization_code</code>, which still defaults to giving us the <code>read</code> scope. However, while authorizing our user, we requested a certain <code>scope</code> &ndash; pass the exact same value here.</li><li>The <code>code</code> can only be used once. If you need to obtain a new token, you will need to have the user authorize again by repeating the above <a href=/en/client/authorized/#authorize-the-user>Authorize the user</a> step.</li></ul><p>The response of this method is a <a href=/en/entities/token/>Token</a> entity. We will need the <code>access_token</code> value. Once you have the access token, save it in your local cache. To use it in requests, add the HTTP header <code>Authorization: Bearer ...</code> to any API call that requires OAuth (i.e., one that is not publicly accessible). Let's verify that our obtained credentials are working by calling <a href=/en/methods/accounts/#verify-account-credentials>GET /api/v1/accounts/verify_credentials</a>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl <span style=color:#f1fa8c>\
</span><span style=color:#f1fa8c></span>	-H <span style=color:#f1fa8c>&#39;Authorization: Bearer our_access_token_here&#39;</span> <span style=color:#f1fa8c>\
</span><span style=color:#f1fa8c></span>	https://mastodon.example/api/v1/accounts/verify_credentials
</code></pre></div><p>If we've obtained our token and formatted our request correctly, we should see our details returned to us as an <a href=/en/entities/account/>Account</a> entity, with the <code>source</code> parameter included.</p><h2 id=actions>Performing actions as the authorized user</h2><p>With our OAuth token for the authorized user, we can now perform any action as that user that is within our token's scope.</p><h3 id=statuses>Publish and delete statuses</h3><ul><li>See <a href=/en/methods/statuses/#publish-new-status>POST /api/v1/statuses</a> for how to create statuses.<ul><li>See <a href=/en/methods/statuses/media/>/api/v1/media</a> for creating media attachments.</li><li>See <a href=/en/methods/statuses/scheduled_statuses/>/api/v1/scheduled_statuses</a> for managing scheduled statuses.</li></ul></li></ul><h3 id=timelines>Interact with timelines</h3><ul><li>See <a href=/en/methods/timelines/>/api/v1/timelines</a> for accessing timelines.</li><li>See <a href=/en/methods/timelines/markers/>/api/v1/markers</a> for saving and loading positions in timelines.</li><li>See <a href=/en/methods/statuses/>/api/v1/statuses</a> for performing actions on statuses.<ul><li>See <a href=/en/methods/statuses/polls/>/api/v1/polls</a> for viewing and voting on polls.</li></ul></li><li>See <a href=/en/methods/timelines/lists/>/api/v1/lists</a> for obtaining list IDs to use with <a href=/en/methods/timelines/#list-timeline>GET /api/v1/timelines/list/:list_id</a>.</li><li>See <a href=/en/methods/timelines/conversations/>/api/v1/conversations</a> for obtaining direct conversations.</li><li>See <a href=/en/methods/accounts/favourites/>/api/v1/favourites</a> for listing favourites.</li><li>See <a href=/en/methods/accounts/bookmarks/>/api/v1/bookmarks</a> for listing bookmarks.</li></ul><h3 id=accounts>Interact with other users</h3><ul><li>See <a href=/en/methods/accounts/>/api/v1/accounts</a> for performing actions on other users.</li><li>See <a href=/en/methods/accounts/follow_requests/>/api/v1/follow_requests</a> for handling follow requests.</li><li>See <a href=/en/methods/accounts/mutes/>/api/v1/mutes</a> for listing mutes.</li><li>See <a href=/en/methods/accounts/blocks/>/api/v1/blocks</a> for listing blocks.</li></ul><h3 id=notifications>Receive notifications</h3><ul><li>See <a href=/en/methods/notifications/>/api/v1/notifications</a> for managing a user's notifications.</li><li>See <a href=/en/methods/notifications/push/>/api/v1/push</a> for subscribing to push notifications.</li></ul><h3 id=discovery>Discovery features</h3><ul><li>See <a href=/en/methods/search/>/api/v2/search</a> for querying resources.</li><li>See <a href=/en/methods/accounts/suggestions/>/api/v1/suggestions</a> for suggested accounts to follow.</li></ul><h3 id=safety>Use safety features</h3><ul><li>See <a href=/en/methods/accounts/filters/>/api/v1/filters</a> for managing filtered keywords.</li><li>See <a href=/en/methods/accounts/domain_blocks/>/api/v1/domain_blocks</a> for managing blocked domains.</li><li>See <a href=/en/methods/accounts/reports/>/api/v1/reports</a> for creating reports.</li><li>See <a href=/en/methods/admin/>/api/v1/admin</a> for moderator actions.</li></ul><h3 id=manage>Manage account info</h3><ul><li>See <a href=/en/methods/accounts/endorsements/>/api/v1/endorsements</a> for managing a user profile's featured accounts.</li><li>See <a href=/en/methods/accounts/featured_tags/>/api/v1/featured_tags</a> for managing a user profile's featured hashtags.</li><li>See <a href=/en/methods/accounts/preferences/>/api/v1/preferences</a> for reading user preferences.</li></ul><p style=color:#687590>Last updated August 10, 2020 · <a href=https://github.com/chasedream1129/mastodon-docs/tree/master/content/en/client/authorized.md style=color:#687590>Improve this page</a></p></div></main></div></body></html>