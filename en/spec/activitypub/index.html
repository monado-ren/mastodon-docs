<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=/favicon.ico><link rel=stylesheet href=https://docs.monado.ren/style.min.ac66b095598a93816a47e5ef5b071058047fa4bd8770cb4515ca10c1ad6f91c0.css><script src=https://docs.monado.ren/main.min.db37c27117ff8400e5e30549f6806d2bc825668b596d81316c6148417f59bc72.js async></script><title>ActivityPub - Mastodon文档 -Monado-</title><meta property="og:type" content="article"><meta property="og:url" content="https://docs.monado.ren/en/spec/activitypub/"><meta name=description content="A decentralized social networking protocol based upon the ActivityStreams 2.0 data format and JSON-LD."><meta property="og:description" content="A decentralized social networking protocol based upon the ActivityStreams 2.0 data format and JSON-LD."><meta name=twitter:description content="A decentralized social networking protocol based upon the ActivityStreams 2.0 data format and JSON-LD."><meta name=twitter:title content="ActivityPub"><meta name=twitter:site content="@joinmastodon"><link rel=canonical href=https://docs.monado.ren/en/spec/activitypub/></head><body><div class="container sidebar-layout"><nav class=sidebar><a class=brand href=/><img class=link-logo src=/brand.svg alt=Mastodon></a><ul><li><a href=/en/>What is Mastodon?</a></li><li><span class=sub-title>Using Mastodon</span><ul class=sub-menu><li><a href=/en/user/signup/>Signing up for an account</a></li><li><a href=/en/user/profile/>Setting up your profile</a></li><li><a href=/en/user/posting/>Posting toots</a></li><li><a href=/en/user/network/>Using the network features</a></li><li><a href=/en/user/moderating/>Dealing with unwanted content</a></li><li><a href=/en/user/discoverability/>Promoting yourself and others</a></li><li><a href=/en/user/preferences/>Set your preferences</a></li><li><a href=/en/user/contacts/>More settings</a></li><li><a href=/en/user/external/>Using Mastodon externally</a></li><li><a href=/en/user/moving/>Moving or leaving accounts</a></li><li><a href=/en/user/run-your-own/>Running your own server</a></li></ul></li><li><span class=sub-title>Running Mastodon</span><ul class=sub-menu><li><a href=/en/admin/prerequisites/>Preparing your machine</a></li><li><a href=/en/admin/install/>Installing from source</a></li><li><a href=/en/admin/config/>Configuring your environment</a></li><li><a href=/en/admin/optional/>Installing optional features</a><ul class=sub-menu><li><a href=/en/admin/optional/elasticsearch/>Full-text search</a></li><li><a href=/en/admin/optional/tor/>Hidden services</a></li><li><a href=/en/admin/optional/sso/>Single Sign On</a></li></ul></li><li><a href=/en/admin/setup/>Setting up your new instance</a></li><li><a href=/en/admin/tootctl/>Using the admin CLI</a></li><li><a href=/en/admin/upgrading/>Upgrading to a new release</a></li><li><a href=/en/admin/backups/>Backing up your server</a></li><li><a href=/en/admin/migrating/>Migrating to a new machine</a></li><li><a href=/en/admin/scaling/>Scaling up your server</a></li><li><a href=/en/admin/moderation/>Moderation actions</a></li><li><a href=/en/admin/troubleshooting/>Troubleshooting errors</a><ul class=sub-menu><li><a href=/en/admin/troubleshooting/index-corruption/>Database index corruption</a></li></ul></li></ul></li><li><span class=sub-title>Developing Mastodon apps</span><ul class=sub-menu><li><a href=/en/client/intro/>Getting started with the API</a></li><li><a href=/en/client/public/>Playing with public data</a></li><li><a href=/en/client/token/>Obtaining client app access</a></li><li><a href=/en/client/authorized/>Logging in with an account</a></li><li><a href=/en/client/guidelines/>Guidelines and best practices</a></li><li><a href=/en/client/libraries/>Libraries and implementations</a></li></ul></li><li><span class=sub-title>Contributing to Mastodon</span><ul class=sub-menu><li><a href=/en/dev/overview/>Technical overview</a></li><li><a href=/en/dev/setup/>Setting up a dev environment</a></li><li><a href=/en/dev/code/>Code structure</a></li><li><a href=/en/dev/routes/>Routes</a></li><li><a href=/en/dev/disclosure/>Bug bounties and responsible disclosure</a></li></ul></li><li><span class=sub-title>Spec compliance</span><ul class=sub-menu><li><a href=/en/spec/activitypub/ class=active>ActivityPub</a></li><li><a href=/en/spec/webfinger/>WebFinger</a></li><li><a href=/en/spec/security/>Security</a></li><li><a href=/en/spec/microformats/>Microformats</a></li><li><a href=/en/spec/oauth/>OAuth</a></li><li><a href=/en/spec/bearcaps/>Bearcaps</a></li></ul></li><li><span class=sub-title>REST API</span><ul class=sub-menu><li><a href=/en/api/oauth-scopes/>OAuth Scopes</a></li><li><a href=/en/api/rate-limits/>Rate limits</a></li></ul></li><li><span class=sub-title>API Methods</span><ul class=sub-menu><li><a href=/en/methods/apps/>apps</a><ul class=sub-menu><li><a href=/en/methods/apps/oauth/>oauth</a></li></ul></li><li><a href=/en/methods/accounts/>accounts</a><ul class=sub-menu><li><a href=/en/methods/accounts/bookmarks/>bookmarks</a></li><li><a href=/en/methods/accounts/favourites/>favourites</a></li><li><a href=/en/methods/accounts/mutes/>mutes</a></li><li><a href=/en/methods/accounts/blocks/>blocks</a></li><li><a href=/en/methods/accounts/domain_blocks/>domain_blocks</a></li><li><a href=/en/methods/accounts/filters/>filters</a></li><li><a href=/en/methods/accounts/reports/>reports</a></li><li><a href=/en/methods/accounts/follow_requests/>follow_requests</a></li><li><a href=/en/methods/accounts/endorsements/>endorsements</a></li><li><a href=/en/methods/accounts/featured_tags/>featured_tags</a></li><li><a href=/en/methods/accounts/preferences/>preferences</a></li><li><a href=/en/methods/accounts/suggestions/>suggestions</a></li></ul></li><li><a href=/en/methods/statuses/>statuses</a><ul class=sub-menu><li><a href=/en/methods/statuses/media/>media</a></li><li><a href=/en/methods/statuses/polls/>polls</a></li><li><a href=/en/methods/statuses/scheduled_statuses/>scheduled_statuses</a></li></ul></li><li><a href=/en/methods/timelines/>timelines</a><ul class=sub-menu><li><a href=/en/methods/timelines/conversations/>conversations</a></li><li><a href=/en/methods/timelines/lists/>lists</a></li><li><a href=/en/methods/timelines/markers/>markers</a></li><li><a href=/en/methods/timelines/streaming/>streaming</a></li></ul></li><li><a href=/en/methods/notifications/>notifications</a><ul class=sub-menu><li><a href=/en/methods/notifications/push/>push</a></li></ul></li><li><a href=/en/methods/search/>search</a></li><li><a href=/en/methods/instance/>instance</a><ul class=sub-menu><li><a href=/en/methods/instance/trends/>trends</a></li><li><a href=/en/methods/instance/directory/>directory</a></li><li><a href=/en/methods/instance/custom_emojis/>custom_emojis</a></li></ul></li><li><a href=/en/methods/admin/>admin</a></li><li><a href=/en/methods/announcements/>announcements</a></li><li><a href=/en/methods/proofs/>proofs</a></li><li><a href=/en/methods/oembed/>oembed</a></li></ul></li><li><span class=sub-title>API Entities</span><ul class=sub-menu><li><a href=/en/entities/account/>Account</a></li><li><a href=/en/entities/activity/>Activity</a></li><li><a href=/en/entities/admin-account/>Admin::Account</a></li><li><a href=/en/entities/admin-report/>Admin::Report</a></li><li><a href=/en/entities/announcement/>Announcement</a></li><li><a href=/en/entities/announcementreaction/>AnnouncementReaction</a></li><li><a href=/en/entities/application/>Application</a></li><li><a href=/en/entities/attachment/>Attachment</a></li><li><a href=/en/entities/card/>Card</a></li><li><a href=/en/entities/context/>Context</a></li><li><a href=/en/entities/conversation/>Conversation</a></li><li><a href=/en/entities/emoji/>Emoji</a></li><li><a href=/en/entities/error/>Error</a></li><li><a href=/en/entities/featuredtag/>FeaturedTag</a></li><li><a href=/en/entities/field/>Field</a></li><li><a href=/en/entities/filter/>Filter</a></li><li><a href=/en/entities/history/>History</a></li><li><a href=/en/entities/identityproof/>IdentityProof</a></li><li><a href=/en/entities/instance/>Instance</a></li><li><a href=/en/entities/list/>List</a></li><li><a href=/en/entities/marker/>Marker</a></li><li><a href=/en/entities/mention/>Mention</a></li><li><a href=/en/entities/notification/>Notification</a></li><li><a href=/en/entities/poll/>Poll</a></li><li><a href=/en/entities/preferences/>Preferences</a></li><li><a href=/en/entities/pushsubscription/>PushSubscription</a></li><li><a href=/en/entities/relationship/>Relationship</a></li><li><a href=/en/entities/report/>Report</a></li><li><a href=/en/entities/results/>Results</a></li><li><a href=/en/entities/scheduledstatus/>ScheduledStatus</a></li><li><a href=/en/entities/source/>Source</a></li><li><a href=/en/entities/status/>Status</a></li><li><a href=/en/entities/tag/>Tag</a></li><li><a href=/en/entities/token/>Token</a></li></ul></li></ul></nav><main><h1>ActivityPub</h1><p>A decentralized social networking protocol based upon the ActivityStreams 2.0 data format and JSON-LD.</p><aside><nav id=TableOfContents><ul><li><ul><li><a href=#status>Status federation</a></li><li><a href=#profile>Profile federation</a></li><li><a href=#sanitization>HTML sanitization</a></li><li><a href=#namespaces>JSON-LD Namespacing</a></li><li><a href=#extensions>Extensions</a></li><li><a href=#other-functionality>Other functionality</a></li></ul></li></ul></nav></aside><div class=e-content><div class="hint hint-warning"><div class=hint-icon><i class="fa fa-exclamation-circle"></i></div>Sample payloads will be added at a future date.</div><h2 id=status>Status federation</h2><a href=https://github.com/tootsuite/mastodon/blob/master/app/lib/activitypub/activity.rb class=page-ref><div class=page-ref-icon><i class="fa fa-external-link-square-alt"></i></div>app/lib/activitypub/activity.rb</a><h3 id=supported-activities-for-statuses>Supported activities for statuses</h3><ul><li>Create = transformed into a status and saved into database</li><li>Delete = removes a status from the database</li><li>Like = transformed into a favourite on a status</li><li>Announce = transformed into a boost on a status</li><li>Flag = transformed into a report to the moderation team.</li><li>Update = only supported on polls. Used to refresh vote count.</li><li>Undo = undo a previous Like or Announce.</li></ul><h3 id=payloads>Payloads</h3><p>The first-class Object types supported by Mastodon are <code>Note</code> and <code>Question</code>.</p><ul><li>Notes are transformed into regular statuses.</li><li>Questions are transformed into a poll status.</li></ul><p>Some other Object types are converted as best as possible. The transformer uses <code>content</code> if available, or <code>name</code> if not, in order to generate status text. The <code>url</code> will be appended. The <code>summary</code> property will be used as the CW text. The <code>icon</code> will be used as a thumbnail.</p><ul><li>Article</li><li>Page</li><li>Image</li><li>Audio</li><li>Video</li><li>Event</li></ul><h2 id=profile>Profile federation</h2><h3 id=supported-activities-for-profiles>Supported activities for profiles</h3><ul><li>Follow = Indicate interest in receiving status updates from a profile.</li><li>Accept/Reject = used to approve or deny Follow activities. Unlocked accounts will automatically reply with an Accept, while locked accounts can manually choose whether to approve or deny a follow request.</li><li>Add/Remove = manage pinned posts and featured collections.</li><li>Block = Signal to a remote server that they should hide your profile from that user. Not guaranteed.</li><li>Flag = report user</li><li>Update = refresh account details</li><li>Move = migrate followers from one account to another. Requires alsoKnownAs to be set in both directions.</li><li>Delete = remove an account from the database, as well as all of their statuses.</li><li>Undo = undo a previous Follow, Accept Follow, or Block.</li></ul><h3 id=properties-used>Properties used</h3><table><thead><tr><th align=left>Property</th><th align=left>Interpretation</th></tr></thead><tbody><tr><td align=left>preferredUsername</td><td align=left>Used for Webfinger lookup. Must be unique on the domain, and must correspond to a Webfinger <code>acct:</code> URI.</td></tr><tr><td align=left>name</td><td align=left>Used as profile display name.</td></tr><tr><td align=left>summary</td><td align=left>Used as profile bio.</td></tr><tr><td align=left>type</td><td align=left>Assumed to be Person. If type is Application or Service, it will be interpreted as a bot flag.</td></tr><tr><td align=left>url</td><td align=left>Used as profile link.</td></tr><tr><td align=left>icon</td><td align=left>Used as profile avatar.</td></tr><tr><td align=left>image</td><td align=left>Used as profile header.</td></tr><tr><td align=left>manuallyApprovesFollowers</td><td align=left>Will be shown as a locked account.</td></tr><tr><td align=left>discoverable</td><td align=left>Will be shown in the profile directory. See <a href=/en/spec/activitypub/#discoverable>Discoverability flag</a>.</td></tr><tr><td align=left>publicKey</td><td align=left>Required for signatures. See <a href=/en/spec/activitypub/#public-key>Public key</a>.</td></tr><tr><td align=left>featured</td><td align=left>Pinned posts. See <a href=/en/spec/activitypub/#featured>Featured collection</a>.</td></tr><tr><td align=left>attachment</td><td align=left>Used for profile fields. See <a href=/en/spec/activitypub/#profile-metadata>Profile metadata</a> and <a href=/en/spec/activitypub/#identityproof>Identity proofs</a>.</td></tr><tr><td align=left>alsoKnownAs</td><td align=left>Required for Move activity.</td></tr></tbody></table><h2 id=sanitization>HTML sanitization</h2><a href=https://github.com/tootsuite/mastodon/blob/master/app/lib/sanitize_config.rb class=page-ref><div class=page-ref-icon><i class="fa fa-external-link-square-alt"></i></div>app/lib/sanitize_config.rb</a><p>Mastodon sanitizes incoming HTML in order to not break assumptions for API client developers. Supported elements include <code>&lt;p></code>, <code>&lt;span></code>, <code>&lt;br></code>, and <code>&lt;a></code>. Unsupported elements will be converted to <code>&lt;p></code>.The sanitizer will keep classes if they begin with microformats prefixes or are semantic classes:</p><ul><li>h-*</li><li>p-*</li><li>u-*</li><li>dt-*</li><li>e-*</li><li>mention</li><li>hashtag</li><li>ellipsis</li><li>invisible</li></ul><h2 id=namespaces>JSON-LD Namespacing</h2><a href=https://github.com/tootsuite/mastodon/blob/master/app/lib/activitypub/adapter.rb class=page-ref><div class=page-ref-icon><i class="fa fa-external-link-square-alt"></i></div>app/lib/activitypub/adapter.rb</a><h3 id=toot>Mastodon extensions (<code>toot:</code>)</h3><p>Contains definitions for Mastodon features.</p><ul><li>toot:Emoji</li><li>toot:IdentityProof</li><li>toot:blurhash</li><li>toot:focalPoint</li><li>toot:featured</li><li>toot:featuredTags</li><li>toot:discoverable</li><li>toot:suspended</li><li>toot:votersCount</li></ul><h3 id=as>ActivityStreams extensions (<code>as:</code>)</h3><p>Contains ActivityStreams extended properties that have been proposed but not officially adopted yet.</p><ul><li>as:Hashtag</li><li>as:alsoKnownAs</li><li>as:manuallyApprovesFollowers</li><li>as:movedTo</li><li>as:sensitive</li></ul><h3 id=sec>W3ID Security Vocabulary (<code>sec:</code>)</h3><p>Contains properties used for HTTPS Signatures and Linked Data Signatures. Also used for identity proofs. See <a href=/en/spec/security/>Security</a> for more information.</p><ul><li>sec:publicKey</li><li>sec:publicKeyPem</li><li>sec:owner</li><li>sec:signature</li><li>sec:signatureValue</li></ul><h4 id=w3id-identity>W3ID Identity</h4><p>Contains a collection of terms from various namespaces, used for Linked Data Signatures.</p><ul><li>dc:creator</li><li>dc:created</li><li>sec:signature</li><li>sec:signatureValue</li></ul><h3 id=schema>schema.org extensions (<code>schema:</code>)</h3><p>Contains properties used for profile metadata.</p><ul><li>schema:PropertyValue</li><li>schema:value</li></ul><h2 id=extensions>Extensions</h2><h3 id=publicKey>Public key</h3><p>Public keys are used for HTTPS Signatures and Linked Data Signatures. This is implemented using an extra property <code>publicKey</code> on actor objects. See <a href=/en/spec/security/>Security</a> for more information. Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
  <span style=color:#f1fa8c>&#34;@context&#34;</span><span style=color:#ff79c6>:</span> [
    <span style=color:#f1fa8c>&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    <span style=color:#f1fa8c>&#34;https://w3id.org/security/v1&#34;</span>
  ],
  <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://mastodon.social/users/Gargron&#34;</span>,
  <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Person&#34;</span>,
  <span style=color:#f1fa8c>&#34;publicKey&#34;</span><span style=color:#ff79c6>:</span> {
    <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://mastodon.social/users/Gargron#main-key&#34;</span>,
    <span style=color:#f1fa8c>&#34;owner&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://mastodon.social/users/Gargron&#34;</span>,
    <span style=color:#f1fa8c>&#34;publicKeyPem&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvXc4vkECU2/CeuSo1wtn\nFoim94Ne1jBMYxTZ9wm2YTdJq1oiZKif06I2fOqDzY/4q/S9uccrE9Bkajv1dnkO\nVm31QjWlhVpSKynVxEWjVBO5Ienue8gND0xvHIuXf87o61poqjEoepvsQFElA5ym\novljWGSA/jpj7ozygUZhCXtaS2W5AD5tnBQUpcO0lhItYPYTjnmzcc4y2NbJV8hz\n2s2G8qKv8fyimE23gY1XrPJg+cRF+g4PqFXujjlJ7MihD9oqtLGxbu7o1cifTn3x\nBfIdPythWu5b4cujNsB3m3awJjVmx+MHQ9SugkSIYXV0Ina77cTNS0M2PYiH1PFR\nTwIDAQAB\n-----END PUBLIC KEY-----\n&#34;</span>
  }
}
</code></pre></div><h3 id=featured>Featured collection</h3><p>What is known in Mastodon as “pinned toots”, or statuses that are always featured at the top of people’s profiles, is implemented using an extra property <code>featured</code> on the actor object that points to a <code>Collection</code> of objects. Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
  <span style=color:#f1fa8c>&#34;@context&#34;</span><span style=color:#ff79c6>:</span> [
    <span style=color:#f1fa8c>&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style=color:#f1fa8c>&#34;toot&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;http://joinmastodon.org/ns#&#34;</span>,
      <span style=color:#f1fa8c>&#34;featured&#34;</span><span style=color:#ff79c6>:</span> {
        <span style=color:#f1fa8c>&#34;@id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;toot:featured&#34;</span>,
        <span style=color:#f1fa8c>&#34;@type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;@id&#34;</span>
      }
    }
  ],

  <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/@alice&#34;</span>,
  <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Person&#34;</span>,
  <span style=color:#f1fa8c>&#34;featured&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/@alice/collections/featured&#34;</span>
}
</code></pre></div><h3 id=featuredTags>Featured tags</h3><p>Mastodon allows users to feature specific hashtags on their profile for easy browsing, as a discoverability mechanism. This is implemented using an extra property <code>featuredTags</code> on the actor object that points to a <code>Collection</code> of <code>Hashtag</code> objects specifically.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
  <span style=color:#f1fa8c>&#34;@context&#34;</span><span style=color:#ff79c6>:</span> [
    <span style=color:#f1fa8c>&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style=color:#f1fa8c>&#34;toot&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;http://joinmastodon.org/ns#&#34;</span>,
      <span style=color:#f1fa8c>&#34;featuredTags&#34;</span><span style=color:#ff79c6>:</span> {
        <span style=color:#f1fa8c>&#34;@id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;toot:featuredTags&#34;</span>,
        <span style=color:#f1fa8c>&#34;@type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;@id&#34;</span>
      }
    }
  ],

  <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/@alice&#34;</span>,
  <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Person&#34;</span>,
  <span style=color:#f1fa8c>&#34;featuredTags&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/@alice/collections/tags&#34;</span>
}
</code></pre></div><h3 id=emoji>Custom emojis</h3><p>Mastodon supports arbitrary emojis, that is, small images uploaded by admins and invokable via shortcodes. For this, an <code>Emoji</code> type is used. These emojis are listed in the <code>tag</code> property just like <code>Mention</code> and <code>Hashtag</code> objects, since they are entities that affect how the text is rendered. Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
  <span style=color:#f1fa8c>&#34;@context&#34;</span><span style=color:#ff79c6>:</span> [
    <span style=color:#f1fa8c>&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style=color:#f1fa8c>&#34;toot&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;http://joinmastodon.org/ns#&#34;</span>,
      <span style=color:#f1fa8c>&#34;Emoji&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;toot:Emoji&#34;</span>
    }
  ],

  <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/@alice/hello-world&#34;</span>,
  <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Note&#34;</span>,
  <span style=color:#f1fa8c>&#34;content&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Hello world :kappa:&#34;</span>,
  <span style=color:#f1fa8c>&#34;tag&#34;</span><span style=color:#ff79c6>:</span> [
    {
      <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/emoji/123&#34;</span>,
      <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Emoji&#34;</span>,
      <span style=color:#f1fa8c>&#34;name&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;:kappa:&#34;</span>,
      <span style=color:#f1fa8c>&#34;icon&#34;</span><span style=color:#ff79c6>:</span> {
        <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Image&#34;</span>,
        <span style=color:#f1fa8c>&#34;mediaType&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;image/png&#34;</span>,
        <span style=color:#f1fa8c>&#34;url&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/files/kappa.png&#34;</span>
      }
    }
  ]
}
</code></pre></div><h3 id=focalPoint>Focal points</h3><p>Mastodon supports setting a focal point on uploaded images, so that wherever that image is displayed, the focal point stays in view. This is implemented using an extra property <code>focalPoint</code> on <code>Image</code> objects. The property is simply an array of two floating points between -1.0 and 1.0, with 0,0 being the center of the image, the first value being x (-1.0 is the left edge, +1.0 is the right edge) and the second value being y (-1.0 is the bottom edge, +1.0 is the top edge). See <a href=/en/methods/statuses/media/#focal-points>Focal points</a> for more information. Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
  <span style=color:#f1fa8c>&#34;@context&#34;</span><span style=color:#ff79c6>:</span> [
    <span style=color:#f1fa8c>&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style=color:#f1fa8c>&#34;toot&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;http://joinmastodon.org/ns#&#34;</span>,
      <span style=color:#f1fa8c>&#34;focalPoint&#34;</span><span style=color:#ff79c6>:</span> {
        <span style=color:#f1fa8c>&#34;@container&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;@list&#34;</span>,
        <span style=color:#f1fa8c>&#34;@id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;toot:focalPoint&#34;</span>
      }
    }
  ],

  <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/@alice/hello-world&#34;</span>,
  <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Note&#34;</span>,
  <span style=color:#f1fa8c>&#34;content&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;A picture attached!&#34;</span>,
  <span style=color:#f1fa8c>&#34;attachment&#34;</span><span style=color:#ff79c6>:</span> [
    {
      <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Image&#34;</span>,
      <span style=color:#f1fa8c>&#34;mediaType&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;image/png&#34;</span>,
      <span style=color:#f1fa8c>&#34;url&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/files/cats.png&#34;</span>,
      <span style=color:#f1fa8c>&#34;focalPoint&#34;</span><span style=color:#ff79c6>:</span> [
        <span style=color:#ff79c6>-</span><span style=color:#bd93f9>0.55</span>,
        <span style=color:#bd93f9>0.43</span>
      ]
    }
  ]
}
</code></pre></div><h3 id=blurhash>Blurhash</h3><p>Mastodon generates colorful preview thumbnails for attachments. This is implemented using an extra property <code>blurhash</code> on <code>Image</code> objects. The property is a string generated by the <a href=https://blurha.sh>BlurHash algorithm</a>. Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
  <span style=color:#f1fa8c>&#34;@context&#34;</span><span style=color:#ff79c6>:</span> [
    <span style=color:#f1fa8c>&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style=color:#f1fa8c>&#34;toot&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;http://joinmastodon.org/ns#&#34;</span>,
      <span style=color:#f1fa8c>&#34;blurhash&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;toot:blurhash&#34;</span>
    }
  ],

  <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/@alice/hello-world&#34;</span>,
  <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Note&#34;</span>,
  <span style=color:#f1fa8c>&#34;content&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;A picture attached!&#34;</span>,
  <span style=color:#f1fa8c>&#34;attachment&#34;</span><span style=color:#ff79c6>:</span> [
    {
      <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Image&#34;</span>,
      <span style=color:#f1fa8c>&#34;mediaType&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;image/png&#34;</span>,
      <span style=color:#f1fa8c>&#34;url&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/files/cats.png&#34;</span>,
      <span style=color:#f1fa8c>&#34;blurhash&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;UBL_:rOpGG-oBUNG,qRj2so|=eE1w^n4S5NH&#34;</span>
    }
  ]
}
</code></pre></div><h3 id=PropertyValue>Profile metadata</h3><p>Mastodon supports arbitrary profile fields containing name-value pairs. This is implemented using the <code>attachment</code> property on actor objects, with objects in the array having a type of <code>PropertyValue</code> and a <code>value</code> property, both from the schema.org namespace. Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
  <span style=color:#f1fa8c>&#34;@context&#34;</span><span style=color:#ff79c6>:</span> [
    <span style=color:#f1fa8c>&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style=color:#f1fa8c>&#34;PropertyValue&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;schema:PropertyValue&#34;</span>,
      <span style=color:#f1fa8c>&#34;value&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;schema:value&#34;</span>
    }
  ],
  <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://mastodon.social/users/Gargron&#34;</span>,
  <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Person&#34;</span>,
  <span style=color:#f1fa8c>&#34;attachment&#34;</span><span style=color:#ff79c6>:</span> [
    {
      <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;PropertyValue&#34;</span>,
      <span style=color:#f1fa8c>&#34;name&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Patreon&#34;</span>,
      <span style=color:#f1fa8c>&#34;value&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;&lt;a href=\&#34;https://www.patreon.com/mastodon\&#34; rel=\&#34;me nofollow noopener noreferrer\&#34; target=\&#34;_blank\&#34;&gt;&lt;span class=\&#34;invisible\&#34;&gt;https://www.&lt;/span&gt;&lt;span class=\&#34;\&#34;&gt;patreon.com/mastodon&lt;/span&gt;&lt;span class=\&#34;invisible\&#34;&gt;&lt;/span}&#34;</span>
    },
    {
      <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;PropertyValue&#34;</span>,
      <span style=color:#f1fa8c>&#34;name&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Homepage&#34;</span>,
      <span style=color:#f1fa8c>&#34;value&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;&lt;a href=\&#34;https://zeonfederated.com\&#34; rel=\&#34;me nofollow noopener noreferrer\&#34; target=\&#34;_blank\&#34;&gt;&lt;span class=\&#34;invisible\&#34;&gt;https://&lt;/span&gt;&lt;span class=\&#34;\&#34;&gt;zeonfederated.com&lt;/span&gt;&lt;span class=\&#34;invisible\&#34;&gt;&lt;/span}&#34;</span>
    }
  ]
}
</code></pre></div><h3 id=IdentityProof>Identity proofs</h3><p>Mastodon supports integration with identity providers to prove that a profile is linked to a certain identity. This is implemented using the <code>attachment</code> property on actor objects, with objects in the array having a type of <code>IdentityProof</code> from the Mastodon namespace. The object also includes <code>signatureAlgorithm</code> and <code>signatureValue</code> from the W3ID Security Vocabulary namespace. Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
  <span style=color:#f1fa8c>&#34;@context&#34;</span><span style=color:#ff79c6>:</span> [
    <span style=color:#f1fa8c>&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    <span style=color:#f1fa8c>&#34;https://w3id.org/security/v1&#34;</span>,
    {
      <span style=color:#f1fa8c>&#34;toot&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;http://joinmastodon.org/ns#&#34;</span>,
      <span style=color:#f1fa8c>&#34;IdentityProof&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;toot:IdentityProof&#34;</span>
    }
  ],
  <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://mastodon.social/users/Gargron&#34;</span>,
  <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Person&#34;</span>,
  <span style=color:#f1fa8c>&#34;attachment&#34;</span><span style=color:#ff79c6>:</span> [
    {
      <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;IdentityProof&#34;</span>,
      <span style=color:#f1fa8c>&#34;name&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;gargron&#34;</span>,
      <span style=color:#f1fa8c>&#34;signatureAlgorithm&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;keybase&#34;</span>,
      <span style=color:#f1fa8c>&#34;signatureValue&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;5cfc20c7018f2beefb42a68836da59a792e55daa4d118498c9b1898de7e845690f&#34;</span>
    }
  ]
}
</code></pre></div><h3 id=discoverable>Discoverability flag</h3><p>Mastodon allows users to opt-in or opt-out of discoverability features like the profile directory. This flag may also be used as an indicator of the user's preferences toward being included in external discovery services, such as search engines or other indexing tools. If you are implementing such a tool, it is recommended that you respect this property if it is present. This is implemented using an extra property <code>discoverable</code> on objects. Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
  <span style=color:#f1fa8c>&#34;@context&#34;</span><span style=color:#ff79c6>:</span> [
    <span style=color:#f1fa8c>&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style=color:#f1fa8c>&#34;toot&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;http://joinmastodon.org/ns#&#34;</span>,
      <span style=color:#f1fa8c>&#34;discoverable&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;toot:discoverable&#34;</span>
    }
  ],
  <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://mastodon.social/users/Gargron&#34;</span>,
  <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Person&#34;</span>,
  <span style=color:#f1fa8c>&#34;discoverable&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#ff79c6>true</span>
}
</code></pre></div><h3 id=suspended>Suspended flag</h3><p>Mastodon reports whether a user was locally suspended, for better handling of these accounts. Suspended accounts in Mastodon return empty data. If a remote account is marked as suspended, it cannot be unsuspended locally. Suspended accounts can be targeted by activities such as Update, Undo, Reject, and Delete. This functionality is implemented using an extra property <code>suspended</code> on objects. Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>{
  <span style=color:#f1fa8c>&#34;@context&#34;</span><span style=color:#ff79c6>:</span> [
    <span style=color:#f1fa8c>&#34;https://www.w3.org/ns/activitystreams&#34;</span>,
    {
      <span style=color:#f1fa8c>&#34;toot&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;http://joinmastodon.org/ns#&#34;</span>,
      <span style=color:#f1fa8c>&#34;suspended&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;toot:suspended&#34;</span>
    }
  ],
  <span style=color:#f1fa8c>&#34;id&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;https://example.com/@eve&#34;</span>,
  <span style=color:#f1fa8c>&#34;type&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#f1fa8c>&#34;Person&#34;</span>,
  <span style=color:#f1fa8c>&#34;suspended&#34;</span><span style=color:#ff79c6>:</span> <span style=color:#ff79c6>true</span>
}
</code></pre></div><h2 id=other-functionality>Other functionality</h2><h3 id=secure-mode>Secure mode</h3><p>When a Mastodon server runs in secure mode, all cross-server HTTP requests to it must be signed (in other words, even <code>GET</code> requests to public resources). That way, the Mastodon server can choose to reject requests from servers it has blocked and avoid &ldquo;leaking&rdquo; public information. Mastodon itself uses a dedicated system actor to sign such HTTP requests. See <a href=../security>Security</a> for more details on HTTP signatures.</p><p>Secure mode is the foundation upon which &ldquo;limited federation mode&rdquo; is built. A Mastodon server in limited federation mode will only federate with servers its admin has explicitly allowed, and reject all other requests.</p><h3 id=follower-synchronization-mechanism>Follower synchronization mechanism</h3><p>Mastodon has a concept of &ldquo;followers-only&rdquo; posts, but expanding the followers collection is currently handled at the destination rather than at the origin (i.e., not with explicit addressing). Therefore, a mechanism to detect synchronization issues and correct them is needed. This mechanism must work on partial followers collections, rather than the full collection (which may not be public information).</p><p>When delivering a message to a remote user, an optional <code>Collection-Synchronization</code> HTTP header is attached, following the same syntax as the <code>Signature</code> header, with the following attributes:</p><ul><li><code>collectionId</code> = MUST be the sender's <code>followers</code> collection</li><li><code>url</code> = a URL to a partial collection containing the identifiers of the sender's followers residing on the receiver's instance. MUST reside on the same domain as the actor itself, and SHOULD be only accessible with a signed query from the receiver's instance</li><li><code>digest</code> = hexadecimal representation of the XORed SHA256 digests of each of the identifiers in the partial collection</li></ul><p>Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http>POST https://mastodon.social/users/foo/inbox
Collection-Synchronization:
  collectionId=&#34;https://social.sitedethib.com/users/Thib/followers&#34;,
  url=&#34;https://social.sitedethib.com/users/Thib/followers_synchronization&#34;,
  digest=&#34;b08ab6951c7d6cc2b91e17ebd9557da7fae02489728e9332fcb3a97748244d50&#34;
</code></pre></div><p>When a remote user attempts to GET the partial collection <code>url</code>, this request must be signed with HTTP signatures. Example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http>GET https://social.sitedethib.com/users/Thib/followers_synchronization
Signature: ... # a signature from an account on mastodon.social

{
  &#34;@context&#34;: &#34;https://www.w3.org/ns/activitystreams&#34;,
  &#34;id&#34;: &#34;https://social.sitedethib.com/users/Thib/followers?domain=mastodon.social&#34;,
  &#34;type&#34;: &#34;OrderedCollection&#34;,
  &#34;orderedItems&#34;: [
    &#34;https://mastodon.social/users/Gargron&#34;
  ]
}
</code></pre></div><p style=color:#687590>Last updated December 27, 2020 · <a href=https://github.com/chasedream1129/mastodon-docs/tree/master/content/en/spec/activitypub.md style=color:#687590>Improve this page</a></p></div></main></div></body></html>